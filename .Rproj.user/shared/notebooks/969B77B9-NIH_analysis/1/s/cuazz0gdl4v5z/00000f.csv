"0","elections <- read.csv(""data/2024_US_County_Level_Presidential_Results.csv"") %>%"
"0","                mutate(FIPS = str_pad(county_fips, 5, pad = ""0"")) %>%"
"0","                mutate(partisan = ifelse(per_gop > per_dem, ""R"", ""D"")) %>%"
"0","                select(FIPS, partisan) %>%"
"0","                distinct()"
"0",""
"0","urbanicity <- read.csv(""data/Ruralurbancontinuumcodes2023.csv"") %>%"
"0","                mutate(FIPS = str_pad(FIPS, 5, pad = ""0"")) %>%"
"0","                filter(Attribute==""RUCC_2023"") %>%"
"0","                mutate(urban = ifelse(Value %in% c(""1"", ""2"", ""3""), TRUE, FALSE)) %>%"
"0","                select(FIPS, urban) %>%"
"0","                distinct() "
"0",""
"0","county_commute_NIH_sum <- read.csv(""output/methods/NIH_impact_county.csv"") %>%"
"0","                             mutate(FIPS = str_pad(FIPS, 5, pad = ""0""))"
"0",""
"0","commute_NIH <- read.csv(""output/methods/county_commute_NIH.csv"") %>% "
"0","                      mutate(DESTINATION = str_pad(DESTINATION, 5, pad = ""0""),"
"0","                           ORIGIN = str_pad(ORIGIN, 5, pad = ""0""))"
"0","                   "
"0","static_loss <- read.csv(""output/methods/static_loss_county.csv"") %>%"
"0","                      mutate(FIPS = str_pad(FIPS, 5, pad = ""0""))"
"0",""
"0","commute_NIH_sum <- read.csv(""output/methods/NIH_impact_county.csv"") %>%"
"0","                    mutate(FIPS = str_pad(FIPS, 5, pad = ""0""))"
"0",""
"0","term_tab_orig <- read.csv(""data/nih_terminations_airtable - JAMA.csv"") %>%"
"0","  mutate(award_remaining = as.numeric(str_replace(total_estimated_remaining, ""\\$"", """"))) %>%"
"0","  mutate(org_name = toupper(org_name)) %>%"
"0","  mutate(award_remaining_noself = ifelse(cancellation_source == ""Self reported"", 0 , award_remaining)) %>%"
"0","  # exclude reinstated grants"
"0","  filter(is.na(reinstated_est_date)) %>%"
"0","    mutate(award_remaining = ifelse(award_remaining <0 , 0 , award_remaining),"
"0","           award_remaining_noself = ifelse(award_remaining_noself <0 , 0 , award_remaining_noself)) "
"0",""
"0",""
"0","comp <- static_loss %>% "
"0","  select(IDC_econ_loss, terminated_econ_loss, FIPS) %>%"
"0","  rename(static_IDC_loss = IDC_econ_loss,"
"0","         static_term_loss = terminated_econ_loss) %>%"
"0","  right_join(commute_NIH_sum) %>%"
"0","  select(FIPS, IDC_econ_loss, IDC_loss, IDC_job_loss, static_IDC_loss, terminated_econ_loss, static_term_loss, county, state) %>%"
"0","  mutate(static_IDC_loss = replace_na(static_IDC_loss, 0),"
"0","         static_term_loss = replace_na(static_term_loss, 0)) %>% "
"0","  left_join(elections) %>%"
"0","  left_join(urbanicity) %>%"
"0","  filter(! state %in% c(""Guam"", ""American Samoa"", ""Puerto Rico"", ""Virgin Islands"")) "
"2","Joining with `by = join_by(FIPS)`"
"2","Joining with `by = join_by(FIPS)`"
"2","Joining with `by = join_by(FIPS)`"
"0","write.csv(comp, ""static_vs_commuter.csv"", row.names=FALSE)"
"0",""
"0","static_loss_CD <- read.csv(""output/methods/static_loss_cong.csv"") %>%"
"0","                      mutate(GEOID = str_pad(GEOID, 4, pad = ""0""))"
"0",""
"0","commute_NIH_sum_CD <- read.csv(""output/methods/NIH_impact_cong.csv"") %>%"
"0","                    mutate(GEOID = str_pad(GEOID, 4, pad = ""0""))"
"0",""
"0","comp_CD <- static_loss_CD %>% "
"0","  select(IDC_econ_loss, terminated_econ_loss, GEOID) %>%"
"0","  rename(static_IDC_loss = IDC_econ_loss,"
"0","         static_term_loss = terminated_econ_loss) %>%"
"0","  right_join(commute_NIH_sum_CD) %>%"
"0","  select(GEOID, IDC_econ_loss, static_IDC_loss, terminated_econ_loss, static_term_loss, pol_party, state) %>%"
"0","  mutate(static_IDC_loss = replace_na(static_IDC_loss, 0),"
"0","         static_term_loss = replace_na(static_term_loss, 0)) %>% "
"0","  #left_join(elections) %>%"
"0","  #left_join(urbanicity) %>%"
"0","  filter(! state %in% c(""Guam"", ""American Samoa"", ""Puerto Rico"", ""Virgin Islands"")) %>%"
"0","  select(-state)"
"2","Joining with `by = join_by(GEOID)`"
"0","write.csv(comp_CD, file=""static_vs_commuter-CD.csv"", row.names=FALSE)"
"0",""
"0",""
"0","tot_loss <- comp$static_IDC_loss %>% sum(na.rm=TRUE)"
"0","tot_loss"
"1","[1]"
"1"," 16611177192"
"1","
"
"0","comp %>% filter(static_IDC_loss!=0) %>% nrow()"
"1","[1]"
"1"," 376"
"1","
"
"0","comp %>% filter(IDC_econ_loss>100000) %>% dim()"
"1","[1]"
"1"," 2136"
"1","   11"
"1","
"
"0","comp %>% filter(static_term_loss!=0) %>% nrow"
"1","[1]"
"1"," 191"
"1","
"
"0","comp %>% filter(terminated_econ_loss>100000) %>% dim()"
"1","[1]"
"1"," 1185"
"1","   11"
"1","
"
"0","sum(comp$terminated_econ_loss)"
"1","[1]"
"1"," 8162016196"
"1","
"
"0","sum(comp$IDC_econ_loss)"
"1","[1]"
"1"," 16611177192"
"1","
"
"0","term_tab_orig %>% dim()"
"1","[1]"
"1"," 2603"
"1","   47"
"1","
"
"0","sum(term_tab_orig$award_remaining, na.rm=TRUE)"
"1","[1]"
"1"," 3241716234"
"1","
"
"0","# main results"
"0","comp %>% filter(static_IDC_loss==0) %>% nrow()"
"1","[1]"
"1"," 2768"
"1","
"
"0","comp %>% filter(static_IDC_loss!=0) %>% nrow()"
"1","[1]"
"1"," 376"
"1","
"
"0","sum(comp$static_IDC_loss)"
"1","[1]"
"1"," 16611177192"
"1","
"
"0","comp %>% arrange(desc(static_IDC_loss))"
