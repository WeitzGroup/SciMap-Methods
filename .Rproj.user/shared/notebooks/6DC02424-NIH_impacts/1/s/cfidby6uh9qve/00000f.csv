"0",""
"0","#2024 NIH data"
"0","NIH <- read.csv(""data/NIH_raw.csv"")"
"0",""
"0","#select relevant variables"
"0","NIH_clean <- select(NIH, ""Application.ID"", ""Organization.Name"", ""Project.Title"", ""Total.Cost"", ""Direct.Cost.IC"", ""Indirect.Cost.IC"", ""Organization.State"", ""Organization.City"", ""Latitude"", ""Longitude"", ""CFDA.Code"", ""Project.Number"")"
"0",""
"0","#rename columns"
"0","colnames(NIH_clean) <- c(""ID"", ""org_name"", ""title"", ""total"", ""direct"", ""indirect"", "
"0","                         ""state"", ""city"", ""lat"", ""lon"", ""CFDA"",""proj.num"")"
"0",""
"0","#exclude rows with NA for CFDA (these indicate sub-grants like ""cores"" within a center grant)"
"0","NIH_clean <- filter(NIH_clean, !is.na(NIH_clean$CFDA))"
"0",""
"0","#replace NA values with zeros and sum directs and indirects"
"0","NIH_clean$direct[is.na(NIH_clean$direct)] <- 0"
"0","NIH_clean$indirect[is.na(NIH_clean$indirect)] <- 0"
"0","NIH_clean$grant_funds <- NIH_clean$direct + NIH_clean$indirect"
"0",""
"0","#fix an issue in the raw data where some grants have total values (direct) but no breakdown by direct/indirect"
"0","for (i in 1:nrow(NIH_clean)){"
"0","  if (NIH_clean$grant_funds[i] == 0){"
"0","    NIH_clean$grant_funds[i] <- NIH_clean$total[i]"
"0","    NIH_clean$direct[i] <- NIH_clean$total[i]"
"0","  }"
"0","}"
"0",""
"0","NIH_clean$proj.num <- str_sub(NIH_clean$proj.num, 2)"
"0",""
"0",""
